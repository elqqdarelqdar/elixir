<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Elixir</title>
    <style>
        body { 
            background: rgba(0, 0, 0, 0.8); 
            color: #ff00ff; 
            font-family: 'Arial', sans-serif; 
            margin: 0; 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            overflow: hidden;
        }
        #elixir { 
            font-size: 8rem; 
            font-weight: bold; 
            text-shadow: 0 0 20px #ff00ff;
        }
        #status { 
            font-size: 1rem; 
            color: #00ff00; 
            margin-top: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .recording { animation: blink 1.5s infinite; }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; } }
    </style>
</head>
<body>

    <div id="elixir">5.0</div>
    <div id="status" class="recording">● Слушаю...</div>

    <script>
        let count = 5.0;
        const baseSpeed = 0.35; // Скорость накопления x1
        const display = document.getElementById('elixir');

        // Авто-прирост эликсира
        setInterval(() => {
            if (count < 10) {
                count += baseSpeed / 10;
                if (count > 10) count = 10;
                updateDisplay();
            }
        }, 100);

        function updateDisplay() {
            display.innerText = count.toFixed(1);
        }

        // Распознавание голоса
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (!SpeechRecognition) {
            alert("Ваш браузер не поддерживает распознавание голоса. Используйте Chrome на Android.");
        } else {
            const recognition = new SpeechRecognition();
            recognition.lang = 'ru-RU';
            recognition.continuous = true;
            recognition.interimResults = false;

            const numbersMap = {
                'один': 1, 'раз': 1, 'два': 2, 'три': 3, 'четыре': 4, 
                'пять': 5, 'шесть': 6, 'семь': 7, 'восемь': 8, 'девять': 9, 'десять': 10
            };

            recognition.onresult = (event) => {
                const lastResult = event.results[event.results.length - 1][0].transcript.toLowerCase();
                console.log('Слышу:', lastResult);

                // Ищем цифры в сказанной фразе
                for (let word in numbersMap) {
                    if (lastResult.includes(word)) {
                        count -= numbersMap[word];
                        if (count < 0) count = 0;
                        updateDisplay();
                        break; 
                    }
                }
            };

            // Авто-перезапуск если микрофон отключится
            recognition.onend = () => recognition.start();
            recognition.start();
        }

        // Клик по экрану для сброса (начало боя)
        document.body.onclick = () => {
            count = 5.0;
            updateDisplay();
        };
    </script>
</body>
</html>
